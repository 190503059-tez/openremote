# OpenRemote v3
#
# By default running this profile installs the stack on https://localhost using a
# self-signed SSL certificate, with username 'admin' and password 'secret'.
#
# Install Docker Community edition (https://docker.com/) on Windows, macOS, or Linux.
#
# Start the stack with: docker-compose -p openremote -f profile/demo.yml up
#
# All persistent data is stored on your Docker host in the '../deployment' directory. To
# keep your data, set a custom directory with env variable DEPLOYMENT_DIRECTORY and disable
# SETUP_INIT_CLEAN_DATABASE.
#
# For full documentation, see deploy.yml
#
# This file defines the services to run and their dependencies only.
#
version: '2.1'

services:

  haproxy:
    extends:
      file: deploy.yml
      service: haproxy
    depends_on:
      manager:
        condition: service_healthy

  letsencrypt:
    extends:
      file: deploy.yml
      service: letsencrypt
    depends_on:
      haproxy:
        condition: service_healthy

  manager:
    extends:
      file: deploy.yml
      service: manager
    depends_on:
      keycloak:
        condition: service_healthy

  keycloak:
    extends:
      file: deploy.yml
      service: keycloak
    depends_on:
      postgresql:
        condition: service_healthy

  postgresql:
    extends:
      file: deploy.yml
      service: postgresql
